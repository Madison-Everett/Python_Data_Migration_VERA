import requests
import os
import base64

import time
from json.decoder import JSONDecodeError

filesid = {
147257 : "59008 - UNIV59008_VUMC60584-A1_FE_20170501",
147255 : "59008 - UNIV59008_VUMC60584-A1_FE_20170501",
157802 : "59008 - UNIV59008_VUMC60584-A2_FE 020718",
157803 : "59008 - UNIV59008_VUMC60584-A2_FE 020718",
186348 : "59008 - UNIV59008_VUMC60584-A4_FE_20200405",
186350 : "59008 - UNIV59008_VUMC60584-A4_FE_20200405",
171734 : "59008 - UNIV59008-VUMC60584-A3-Dawant-Sub-FE 041619",
171733 : "59008 - UNIV59008-VUMC60584-A3-Dawant-Sub-FE 041619",
141567 : "59008 - UNIV 59008 FE",
141568 : "59008 - UNIV 59008 FE",
175691 : "59322 - Accenture - VU (Provost) - Amendment 3 to MSA - Ex",
164749 : "59322 - Accenture - VU (Geer) - Amendment 2 to MasterResea",
144727 : "59322 - Document-Vanderbilt MSA_fully executed",
144781 : "59322 - Document-Vanderbilt MSA_fully executed",
154398 : "59322 - Accenture - Vanderbilt Amend 1 FY18_final_signed (",
192934 : "59322 - Accenture - Amendment 4 to MSA - Extends Term to 0",
192935 : "59322 - Accenture - Amendment 4 to MSA - Extends Term to 0",
204595 : "59322 - VU-Accenture MRA - Amendment August 2021 - signed",
154397 : "59322 - Accenture - Vanderbilt Amend 1 FY18_final_signed (",
149235 : "59439 - UNIV59439_FE 20170615",
149238 : "59439 - UNIV59439_FE 20170615",
159999 : "59727 - Coeus 000002611 NY Univ_Orig agreement",
153299 : "59727 - UNIV59727_NY Univ School of Medicine-A2_FE_2017092",
153300 : "59727 - UNIV59727_NY Univ School of Medicine-A3_FE-2017092",
173479 : "59727 - UNIV59727_NY Univ School of Medicine-A4-Grissom-FE",
173481 : "59727 - UNIV59727_NY Univ School of Medicine-A4-Grissom-FE",
160000 : "59727 - 2544-017572 A-1",
175561 : "59727 - UNIV59727_NY Univ School of Medicine-A5-Grissom-Su",
175564 : "59727 - UNIV59727_NY Univ School of Medicine-A5-Grissom-Su",
153289 : "59727 - UNIV59727_NY Univ School of Medicine-A2_FE_2017092",
153290 : "59727 - UNIV59727_NY Univ School of Medicine-A3_FE-2017092",
193572 : "60204 - UNIV60204_VUMC65995_Yang SBA-FE_20201028",
161365 : "60204 - UNIV60204_VUMC65995_FE 060418",
161366 : "60204 - UNIV60204_VUMC65995_FE 060418",
164129 : "60204 - UNIV60204_VUMC65995_Am 1_FE 082018",
164131 : "60204 - UNIV60204_VUMC65995_Am 1_FE 082018",
204673 : "60204 - UNIV60204_VUMC65595_AM 4_Final Draft_20210903",
193573 : "60204 - UNIV60204_VUMC65995_Yang SBA-FE_20201028",
178845 : "60204 - UNIV60204_VUMC65995_Am 2_FE_100119",
178846 : "60204 - UNIV60204_VUMC65995_Am 2_FE_100119",
179271 : "60352 - 191010 Weiss_Vanderbilt-amend1_IN4684797VU-sub 807",
179272 : "60352 - UNIV60352_Indiana University-IN4684797VU_FE_201910",
179274 : "60352 - UNIV60352_Indiana University-IN4684797VU_FE_201910",
192072 : "60352 - UNIV60352_Indiana University sub 8076-Am 2_FE_2020",
192070 : "60352 - UNIV60352_Indiana University sub 8076-Am 2_FE_2020",
204601 : "60352 - UNIV60352_Indiana Universit Sub 8076-A3_FE_2021090",
204603 : "60352 - UNIV60352_Indiana Universit Sub 8076-A3_FE_2021090",
163747 : "60352 - UNIV60352_Indiana University_FE_20180813",
163748 : "60352 - UNIV60352_Indiana University_FE_20180813",
204631 : "60720 - UNIV60720_Fisk University_Am 3_Final Draft_2021090",
191817 : "60720 - UNIV60720_Fisk_FE_20200917",
191818 : "60720 - UNIV60720_Fisk_FE_20200917",
171237 : "60720 - UNIV60720_Fisk U_FE 040319",
171236 : "60720 - UNIV60720_Fisk U_FE 040319",
180997 : "60720 - UNIV60720_Fisk_A1_FE_20191203",
189009 : "60834 - UNIV60834_BU_FE_20200720",
173372 : "60834 - UNIV60834_Brown Univ 00001400_FE 053019",
189011 : "60834 - UNIV60834_BU_FE_20200720",
204659 : "60834 - UNIV60834_BU_PE_20210902 approved",
204660 : "60834 - UNIV60834_BU_PE_20210902 approved",
173371 : "60834 - UNIV60834_Brown Univ 00001400_FE 053019",
177408 : "60975 - UNIV60975_VUMC73788_FE_082819",
177409 : "60975 - UNIV60975_VUMC73788_FE_082819",
185064 : "60975 - UNIV60975_VUMC73788_A1_FE_20200311",
185065 : "60975 - UNIV60975_VUMC73788_A1_FE_20200311",
204655 : "61173 - TDOE_DUA_Amd 2_Vanderbilt TERA_FINAL",
182443 : "61173 - Final 1-20-2020",
194919 : "61199 - N00173191G020-P00002-IF (1) (2)",
204658 : "61199 - N00173-19-1-G020 P00004 INC KO signed",
197415 : "61199 - N00173-19-1-G020 P00003 INC SIGNED GF",
184242 : "61290 - UNIV61290_Johns Hopkins University-A1_FE_20200304",
183681 : "61290 - UNIV61290_Johns Hopkins Universtiy_FE_20200219",
183686 : "61290 - UNIV61290_Johns Hopkins Universtiy_FE_20200219",
183682 : "61290 - UNIV61290_Johns Hopkins Universtiy_FE_20200219",
184241 : "61290 - UNIV61290_Johns Hopkins University-A1_FE_20200304",
185345 : "61404 - FaithIN_UNIV61404_FII_FE_20200406",
204589 : "61404 - UNIV61404_FII_A2_FE_20210901",
203072 : "61434 - UNIV61434_HOPE Family Hlth Serv_FE_20210803",
203074 : "61434 - UNIV61434_HOPE Family Hlth Serv_FE_20210803",
188860 : "61556 - UNIV61556_New York University_Final Draft_20200716",
192388 : "61734 - UNIV61734_VUMCxxxxx_FE_20200930",
204624 : "61734 - UNIV61734_Yale Univ-A1_FE_20210902",
204625 : "61734 - UNIV61734_Yale Univ-A1_FE_20210902",
192389 : "61734 - UNIV61734_VUMCxxxxx_FE_20200930",
191839 : "61748 - UNIV61748_VUMC85210_FE_20200917",
191840 : "61748 - UNIV61748_VUMC85210_FE_20200917",
204627 : "61748 - UNIV61748_VUMC85210_FE_20210902",
204628 : "61748 - UNIV61748_VUMC85210_FE_20210902",
198916 : "61748 - UNIV61748_VUMC85210_Am 1_FE_20210414",
198917 : "61748 - UNIV61748_VUMC85210_Am 1_FE_20210414",
195167 : "61818 - UNIV61818_VUMC84387_FE_20201208",
195169 : "61818 - UNIV61818_VUMC84387_FE_20201208",
204606 : "61818 - UNIV61818_VUMC84387-A1_FE_20210902",
204607 : "61818 - UNIV61818_VUMC84387-A1_FE_20210902",
205114 : "62113 - UNIV62113_VUMC90528_FE_20210916",
201136 : "62169 - UNIV62169_CBI_FE_20210615",
201138 : "62179 - UNIV62179_VUMC91436_FE_20210615",
201137 : "62179 - UNIV62179_VUMC91436_FE_20210615",
200132 : "62189 - UNIV62189 Vanderbilt -w- NAWI_Consortium_Agreement",
204620 : "62189 - 7603622 Vanderbilt NAWI (FE",
204545 : "62190 - UNIV62190_Teachers College, Columbia 511148_FE_202",
204546 : "62190 - UNIV62190_Teachers College, Columbia 511148_FE_202",
204639 : "62198 - UNIV62198_Florida International University 000441_",
200506 : "62198 - UNIV62198_Florida International University 000441_",
201129 : "62201 - UNIV62201_UMC_core_FE_20210615",
201122 : "62207 - UNIV62207_VUMC90902_FE_20210615",
201124 : "62207 - UNIV62207_VUMC90902_FE_20210615",
200879 : "62243 - Carle Foundation - VINSE Ext User Agrmt (FE)",
204586 : "62276 - UNIV62276_VUMC94946_FE_20210902",
204588 : "62276 - UNIV62276_VUMC94946_FE_20210902",
204519 : "62322 - UNIV62322_VUMC93051_FE_20210901",
204520 : "62322 - UNIV62322_VUMC93051_FE_20210901",
205042 : "62332 - UNIV62332_VUMC92999_Final Draft_20210914",
202503 : "62343 - 20210716_UNIV62299_j7msc",
205029 : "62348 - CSL-Vanderbilt RCA (CSL112 in wound healing) (clea",
204647 : "62351 - UNIV62351_UWSC12923_FE_20210902",
204649 : "62351 - UNIV62351_UWSC12923_FE_20210902",
203064 : "62353 - UNIV62353_Wake Forest University Health Sciences_F",
204842 : "62355 - UNIV62355_UP_FE_20210908",
204843 : "62355 - UNIV62355_UP_FE_20210908",
203099 : "62360 - Securboration - Vanderbilt DTME Subcontract - FE (",
204492 : "62362 - UNIV62362_VUMC85790_FE_20210901",
204494 : "62362 - UNIV62362_VUMC85790_FE_20210901",
204432 : "62365 - 20210831125132",
204674 : "62370 - UNIV62370_Augusta University_33737-19_FE_20210903",
204676 : "62370 - UNIV62370_Augusta University_33737-19_FE_20210903",
205104 : "62378 - UNIV62378_Children's Hosptial Medical Center_Final",
204509 : "62397 - UNIV62397_Univ of N. Dakota_FE_20210901",
204511 : "62397 - UNIV62397_Univ of N. Dakota_FE_20210901",
204708 : "62400 - UNIV62400_VUMC93904_Final Draft_20210907",
203924 : "62403 - Siemens Phd Fellowship Agreement _ Vanderbilt (ful",
203929 : "62404 - UNIV62404_CORE_FE_20210823",
204549 : "62407 - UNIV62407_East Carolina University AWD-21-0749-S00",
204547 : "62407 - UNIV62407_East Carolina University AWD-21-0749-S00",
204819 : "62408 - UNIV62408_VUMC94135_Final Draft_20210908",
204803 : "62409 - UNIV62409_The Reg. of the Univ. of CA Berkley_FE_2",
204805 : "62409 - UNIV62409_The Reg. of the Univ. of CA Berkley_FE_2",
204598 : "62415 - UNIV62415_Carle_Foundation_Hospital_FE_20210902",
204600 : "62415 - UNIV62415_Carle_Foundation_Hospital_FE_20210902",
205039 : "62423 - UNIV62423_UCSF12940_Final Draft_20210914",
204976 : "62426 - Contract RG-T3609-P002  VANDERBILT University 09.1",
204431 : "62430 - UNIV62430_IU_CORE_FE_20210901",
205079 : "62434 - UNIV62434_WF_FE_20210915",
205080 : "62434 - UNIV62434_WF_FE_20210915",
205110 : "62438 - UNIV62438_UWis_FE_20210916",
205111 : "62438 - UNIV62438_UWis_FE_20210916"
          }

for x in filesid:
    
    response = requests.get("https://peer.app.vanderbilt.edu/index.php?controller=Api&call=getContractFile&fileId="+str(x)+"&token=dac9630aec642a428cd73f4be0a03569")

    try:
        time.sleep(1)
        message = response.json()["content"]
        message_bytes = message.encode('ascii')
        file = base64.b64decode(message_bytes)
        try:
              os.mkdir("/Users/everetmm/Desktop/woow/Contract_"+filesid[x][0:5])
              print("Directory " , filesid[x][0:5] ," Created ")
              open("/Users/everetmm/Desktop/woow/Contract_"+filesid[x][0:5]+"/Contract "+ filesid[x]+".pdf", 'wb').write(file)
        except FileExistsError:
              print("Directory " , filesid[x][0:5],  " already exists")
              open("/Users/everetmm/Desktop/woow/Contract_"+filesid[x][0:5]+"/Contract "+ filesid[x]+".pdf", 'wb').write(file)

        
    except JSONDecodeError:
        print("    ")
        print(str(x))
        print("    ")

